/* 
   SISTEMA DE IMPRESIÓN "NUCLEAR" (print.css)
   ------------------------------------------
   Diseñado para forzar un formato de reporte profesional en papel A4.
   - Elimina elementos de interfaz (Navbar, botones, fondos de pantalla).
   - Fuerza visibilidad de colores e imágenes de fondo (badges, iconos).
   - Redefine layouts complejos para que encajen en el ancho de página.
   - Optimiza específicamente el "Cierre de Caja" y "Comprobantes de Cobro".
*/

@media print {
  /* 1. RESET DE PÁGINA */
  @page {
    size: A4 portrait;
    margin: 0 !important;
  }

  /* FORZAR IMPRESIÓN DE COLORES Y FONDOS EXACTOS */
  body {
    visibility: hidden !important;
    background: white !important;
    margin: 0 !important;
    padding: 0 !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* FIX: Ocultar placeholders al imprimir */
  input::placeholder,
  textarea::placeholder,
  ::-webkit-input-placeholder {
    color: transparent !important;
    opacity: 0 !important;
    visibility: hidden !important;
    text-shadow: none !important;
  }

  /* FIX: Desactivar sticky para evitar solapamiento (CRÍTICO) */
  .sticky-top {
    position: static !important;
    z-index: auto !important;
  }

  /* FIX: Forzar que la fila de Vales (col-12) salte de línea y ocupe todo */
  #otros-container .col-12 {
    flex: 0 0 100% !important;
    width: 100% !important;
    max-width: 100% !important;
    clear: both !important;
    display: block !important;
  }

  /* FIX: Desactivar sticky para evitar solapamiento */
  .sticky-top {
    position: static !important;
    z-index: auto !important;
  }

  /* FIX: Forzar que la fila de Vales (col-12) caiga abajo y ocupe todo */
  #otros-container .col-12 {
    width: 100% !important;
    float: none !important;
    clear: both !important;
    display: block !important;
    flex: 0 0 100% !important;
  }

  /* FIX: Forzar colores en elementos clave */
  .text-primary,
  .bg-primary,
  .text-danger,
  .bg-danger,
  .badge,
  .alert {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* ... (rest of the file content until specific fixes) ... */

  /* FIX DEFINITIVO DE VISIBILIDAD DE INPUTS (MANTENIENDO COLOR) */

  /* Asegurar que los inputs de sellos, vales, etc se vean bien y tengan espacio */
  .input-group-text {
    background-color: transparent !important;
    /* Permitir color original si lo hay, o default bootstrap */
    border: 1px solid #ccc !important;
    font-weight: bold !important;
  }

  .form-control,
  input {
    border: 1px solid #ccc !important;
    background: transparent !important;
    min-width: 50px !important; /* Evitar colapso */
  }

  /* Regla específica para inputs de sellos y otros conceptos que suelen fallar */
  #caja_sellos_cant,
  #caja_sellos_precio,
  #caja_vales,
  #caja_safe,
  #caja_monedas_extra,
  #caja_desembolsos {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    width: 100% !important;
  }

  /* 3. VISIBILIDAD DE CONTENIDO CLAVE */
  /* Hacemos visible el wrapper y la pestaña activa */
  #app-layout {
    visibility: visible !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    width: 100% !important;
  }

  .tab-content {
    margin: 0 !important;
    padding: 0 !important;
  }

  .tab-pane.active {
    visibility: visible !important;
    display: block !important;

    /* POSICIONAMIENTO ABSOLUTO PARA IGNORAR FLUJO */
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;

    /* Margen de seguridad estético (1cm) */
    padding: 10mm !important;
    margin: 0 !important;

    background: white !important;
    z-index: 9999 !important;
  }

  /* Aseguramos que los hijos sean visibles */
  .tab-pane.active * {
    visibility: visible !important;
  }

  /* 4. RESET CRÍTICO DE CLASES JS (.content-panel, etc) */
  .content-panel,
  [id$="-trabajo"],
  [id$="-rack"] {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    box-shadow: none !important;
    background: transparent !important;
    min-height: auto !important;
  }

  /* 5. OCULTAR ELEMENTOS DE INTERFAZ */
  .no-print,
  .nav,
  .navbar,
  .app-header-panel,
  .module-toolbar,
  .btn,
  .btn-group,
  footer,
  .d-print-none,
  .modal-backdrop,
  .modal {
    display: none !important;
    visibility: hidden !important;
  }

  /* 6. CABECERA DE REPORTE */
  /* 6. CABECERA DE REPORTE */
  body .report-header-print {
    display: flex !important;
    visibility: visible !important;
    width: 100% !important;
    justify-content: space-between !important;
    align-items: flex-start !important;
    border-bottom: 2px solid #0d6efd !important; /* Azul primario */
    margin-bottom: 15px !important;
    padding-bottom: 10px !important;
    margin-top: 0 !important;
  }

  .report-info-left h2 {
    font-size: 16pt !important;
    font-weight: 800 !important;
    margin: 0 0 5px 0 !important;
    text-transform: uppercase !important;
    color: #0d6efd !important; /* Azul primario */
  }

  .report-info-left p {
    font-size: 9pt !important;
    color: #6c757d !important; /* Muted standard */
    margin: 0 !important;
  }

  .report-info-right {
    text-align: right !important;
    font-size: 9pt !important;
  }

  /* 7. TABLAS */
  .table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin-bottom: 0 !important;
  }

  /* Respetar estilos de tabla de pantalla */
  .table th {
    font-weight: bold !important;
    padding: 5px !important;
  }

  .table td {
    padding: 5px !important;
  }

  /* 8. TARJETAS */
  .card {
    border: none !important;
    position: relative !important;
    box-shadow: none !important;
    margin-bottom: 10px !important;
  }

  .card-header {
    border-bottom: 1px solid rgba(0, 0, 0, 0.125) !important;
    padding: 5px 0 !important;
    margin-bottom: 5px !important;
  }

  .card-body {
    padding: 0 !important;
  }

  /* 9. INPUTS CLAROS */
  /* 9. INPUTS CLAROS (Solo ocultar búsqueda) */
  [id*="search"],
  input[type="search"] {
    display: none !important;
  }

  /* Ajuste para inputs de Cierre de Caja en impresión */
  .input-caja {
    border: 1px solid #ddd !important;
    background: transparent !important;
    color: #000 !important;
    font-weight: bold !important;
    padding: 0 5px !important;
    display: inline-block !important; /* Asegurar que se ve */
  }

  .money-label,
  .money-total {
    /* background-color: #f8f9fa !important; <-- REMOVED implicit, handled by bg-light now */
    color: #000 !important;
    border: 1px solid #ddd !important;
  }

  /* 10. ESTILOS DE ELEMENTOS DE MÓDULOS */
  .table-precios-print td {
    vertical-align: middle !important;
  }

  .fs-4 {
    font-size: 1.5rem !important;
  }

  /* --- FIN OVERRIDES --- */

  /* SOLUCIÓN FINAL: Restaurar colores usando variables CSS para soportar opacidad */
  /* Esto sobreescribe el reset de Bootstrap 'print' que pone todo transparente */

  .bg-primary {
    background-color: rgba(13, 110, 253, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-secondary {
    background-color: rgba(108, 117, 125, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-success {
    background-color: rgba(25, 135, 84, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-info {
    background-color: rgba(13, 202, 240, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-warning {
    background-color: rgba(255, 193, 7, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-danger {
    background-color: rgba(220, 53, 69, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-light {
    background-color: rgba(248, 249, 250, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-dark {
    background-color: rgba(33, 37, 41, var(--bs-bg-opacity, 1)) !important;
  }
  .bg-white {
    background-color: rgba(255, 255, 255, var(--bs-bg-opacity, 1)) !important;
  }

  /* Asegurar que el texto blanco sea blanco y no negro/gris */
  .text-white {
    color: #fff !important;
  }
  .text-primary {
    color: #0d6efd !important;
  }
  .text-success {
    color: #198754 !important;
  }
  .text-danger {
    color: #dc3545 !important;
  }
  .text-warning {
    color: #ffc107 !important;
  }
  .text-info {
    color: #0dcaf0 !important;
  }
  .text-muted {
    color: #6c757d !important;
  }

  /* Restaurar Table Variants */
  .table-primary {
    --bs-table-bg: #cfe2ff;
    --bs-table-striped-bg: #c5d7f2;
    --bs-table-striped-color: #000;
    --bs-table-active-bg: #bacbe6;
    --bs-table-active-color: #000;
    --bs-table-hover-bg: #bfd1ec;
    --bs-table-hover-color: #000;
    color: #000;
    border-color: #bacbe6;
  }
  .table-light {
    --bs-table-bg: #f8f9fa;
    --bs-table-striped-bg: #ced4da;
    --bs-table-striped-color: #000;
    --bs-table-active-bg: #dfe0e1;
    --bs-table-active-color: #000;
    --bs-table-hover-bg: #e5e6e7;
    --bs-table-hover-color: #000;
    color: #000;
    border-color: #dfe0e1;
  }

  .table > :not(caption) > * > * {
    background-color: var(--bs-table-bg) !important;
    color: var(--bs-table-color, inherit) !important;
  }

  /* Asegurar que los inputs de sellos, vales, etc se vean bien */
  .input-group-text {
    /* background-color: transparent !important; <-- REMOVED */
    border: 1px solid #ccc !important;
    font-weight: bold !important;
  }

  .form-control,
  input {
    border: 1px solid #000 !important;
    color: #000 !important;
    background: transparent !important;
    min-width: 50px !important; /* Evitar colapso en inputs pequeños */
  }

  /* Regla específica para inputs de sellos y otros conceptos que suelen fallar */
  #caja_sellos_cant,
  #caja_sellos_precio,
  #caja_vales,
  #caja_safe,
  #caja_monedas_extra,
  #caja_desembolsos {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    width: 100% !important; /* Forzar ancho */
  }

  /* Placeholder negro si hiciera falta, aunque inputs suelen tener valor */

  /* Placeholder negro si hiciera falta, aunque inputs suelen tener valor */
}

/* ==========================================================================
   OPTIMIZACIÓN COBRO CLIENTE (A4)
   ========================================================================== */
@media print {
  /* 1. RESET GLOBAL Y OCULTAR LO INNECESARIO */
  body {
    font-family: "Inter", sans-serif !important;
    background: white !important;
    color: black !important;
  }

  #cobro-content button,
  #cobro-content .btn,
  .no-print,
  .module-toolbar,
  .report-header-print {
    display: none !important;
  }

  /* 2. CONTENEDOR PRINCIPAL "RECIBO" */
  #cobro-content {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    background: transparent !important;
  }

  /* 3. ESTRUCTURA DE COMPROBANTE COMPACTO */
  #cobro-content .row {
    display: block !important;
    margin: 0 !important;
  }

  /* Ocultar el layout de columnas original para redefinirlo */
  #cobro-content .col-md-9,
  #cobro-content .col-md-3 {
    width: 100% !important;
    float: none !important;
    padding: 0 !important;
    margin: 0 !important;
    flex: none !important;
  }

  /* 4. BLOQUE DE DATOS CLAVE (SUPER COMPACTO) */
  /* Mover el bloque de totales arriba visualmente */
  #cobro-content .col-md-3 {
    border-bottom: 2px dashed #000 !important;
    padding-bottom: 10px !important;
    margin-bottom: 10px !important;
    order: -1 !important; /* Si usáramos flex, pero aquí forzamos bloque */
    display: flex !important;
    flex-direction: row !important;
    justify-content: space-between !important;
    align-items: center !important;
  }

  /* Total a Cobrar */
  #cobro-content .col-md-3 > div:first-child {
    width: 48% !important;
  }

  /* Resumen Lateral (Cambio/Diferencia) */
  #cobro-content .col-md-3 > .card {
    width: 48% !important;
    border: none !important;
    box-shadow: none !important;
  }

  #cobro_total_a_cobrar {
    font-size: 1.5rem !important;
    font-weight: 900 !important;
    border: 2px solid #000 !important;
    text-align: center !important;
    height: auto !important;
    padding: 5px !important;
    background: #eee !important;
    -webkit-print-color-adjust: exact !important;
  }

  #cobro_cambio_deber {
    font-size: 1.2rem !important;
    font-weight: bold !important;
  }

  #cobro_diferencia_final {
    font-size: 1.4rem !important;
  }

  /* 5. LISTADO DE BILLETES Y MONEDAS (Estilo Tabla densa) */
  #cobro-content .col-md-9 .card {
    border: none !important;
    box-shadow: none !important;
  }

  #cobro-content .card-header {
    display: none !important; /* Ocultar "Calculadora de Cambio" */
  }

  #cobro-content .card-body {
    padding: 0 !important;
  }

  /* Reorganizar en 2 columnas estrictas */
  #cobro-content .card-body .row {
    display: flex !important;
    flex-direction: row !important;
    width: 100% !important;
  }

  #cobro-content .card-body .col-md-6 {
    width: 48% !important;
    padding: 5px !important;
    border: 1px solid #ddd !important;
    margin-right: 2% !important;
  }

  #cobro-content .card-body .col-md-6:last-child {
    margin-right: 0 !important;
  }

  /* Títulos de secciones */
  #cobro-content .text-success,
  #cobro-content .text-danger {
    color: #000 !important;
    border-bottom: 2px solid #000;
    display: block;
    margin-bottom: 5px;
    font-size: 0.9rem !important;
    font-weight: 800 !important;
  }

  #cobro-content i {
    display: none !important;
  }

  /* Inputs ocultos si están vacíos o a 0 */
  #cobro-content input[value=""],
  #cobro-content input[value="0"],
  #cobro-content input:not([value]) {
    /* No podemos ocultar inputs vacíos solo con CSS fácilmente sin :placeholder-shown trick si tienen value="" */
    /* Mejor estrategia: Hacerlos muy discretos */
    border: none !important;
    border-bottom: 1px dotted #ccc !important;
    padding: 0 !important;
    height: 18px !important;
    font-size: 0.8rem !important;
    text-align: right !important;
  }

  #cobro-content .input-group {
    margin-bottom: 2px !important;
    display: flex !important;
    align-items: center !important;
  }

  #cobro-content .input-group-text {
    font-size: 0.75rem !important;
    padding: 0 !important;
    background: transparent !important;
    border: none !important;
    font-weight: bold !important;
    width: 50px !important;
  }
}
