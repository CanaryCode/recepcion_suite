<div class="d-none d-print-block report-header-print">
    <div class="report-info-left">
        <h2>Configuraci√≥n del Sistema</h2>
        <p>Hotel Garo√© ‚Ä¢ Recepci√≥n Suite</p>
    </div>
    <div class="report-info-right">
        <div><strong>Fecha:</strong> <span id="print-date-config"></span></div>
        <div><strong>Generado por:</strong> <span id="print-repc-nombre-config"></span></div>
    </div>
</div>

<!-- Encabezado del M√≥dulo (T√≠tulo Din√°mico) -->
<h4 class="module-title-discrete">
    <i class="bi bi-gear-fill"></i> CONFIGURACI√ìN
</h4>

<!-- Barra de Herramientas -->
<div class="module-toolbar no-print">
    <div class="btn-group" role="group">
        <button class="btn btn-outline-primary active" id="btnConfigMain"
            data-bs-toggle="tooltip" data-bs-title="Editar Configuraci√≥n">
            <i class="bi bi-sliders me-2"></i>General
        </button>
        <button class="btn btn-outline-danger" onclick="resetConfigToDefault()"
            data-bs-toggle="tooltip" data-bs-title="Restaurar valores de f√°brica">
            <i class="bi bi-arrow-counterclockwise me-2"></i>Reset
        </button>
    </div>

    <div class="btn-print-wrapper gap-2">
        <button class="btn btn-success btn-sm fw-bold shadow-sm" onclick="exportConfig()"
            data-bs-toggle="tooltip" data-bs-title="Descargar archivo JSON para guardar cambios permanentemente">
            <i class="bi bi-download me-2"></i>Descargar config.json
        </button>
        <button class="btn btn-primary btn-sm fw-bold shadow-sm" onclick="saveConfigLocal()"
            data-bs-toggle="tooltip" data-bs-title="Aplicar cambios en este navegador">
            <i class="bi bi-save-fill me-2"></i>Aplicar Cambios
        </button>
    </div>
</div>

<!-- Contenedor Principal -->
<div id="configuracion-content-wrapper" class="content-panel animate-fade-in">
    <form id="formConfig" onsubmit="event.preventDefault(); saveConfigLocal();">
        
        <!-- 1. Recepcionistas -->
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header py-3 bg-white">
                <h6 class="mb-0 fw-bold text-primary">
                    <i class="bi bi-people-fill me-2"></i>Equipo de Recepci√≥n
                </h6>
            </div>
            <div class="card-body">
                <p class="small text-muted mb-3">Nombres que aparecer√°n en los selectores de usuario y firmas.</p>
                <div id="config-recepcionistas-list" class="d-flex flex-wrap gap-2 mb-3"></div>
                
                <div class="input-group input-group-sm" style="max-width: 400px;">
                    <input type="text" id="newRecepcionista" class="form-control" placeholder="Nuevo nombre...">
                    <button class="btn btn-outline-primary" type="button" onclick="addRecepcionista()">
                        <i class="bi bi-plus-lg"></i> A√±adir
                    </button>
                </div>
            </div>
        </div>

        <!-- 1.1 Transfers & Destinos -->
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header py-3 bg-white">
                <h6 class="mb-0 fw-bold text-primary">
                    <i class="bi bi-airplane-engines-fill me-2"></i>Transfers & Destinos
                </h6>
            </div>
            <div class="card-body">
                <p class="small text-muted mb-3">Destinos habituales para mostrar en las opciones de "Transfers".</p>
                <div id="list-destinos-transfers" class="d-flex flex-wrap gap-2 mb-3"></div>
                
                <div class="input-group input-group-sm" style="max-width: 400px;">
                    <input type="text" id="newDestinoTransfer" class="form-control" placeholder="Nuevo destino (ej: Aeropuerto)...">
                    <button class="btn btn-outline-primary" type="button" onclick="addDestinoTransfer()">
                        <i class="bi bi-plus-lg"></i> A√±adir
                    </button>
                </div>
            </div>
        </div>

        <!-- 1.2 Ejecutables / Apps Externas -->
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header py-3 bg-white">
                <h6 class="mb-0 fw-bold text-primary">
                    <i class="bi bi-app-indicator me-2"></i>Accesos R√°pidos (Apps)
                </h6>
            </div>
            <div class="card-body">
                <p class="small text-muted mb-3">Botones para lanzar aplicaciones externas desde el dashboard. (Requiere servidor Node.js local).</p>
                
                <div id="list-app-launchers" class="row g-2 mb-3"></div>
                
                <div class="row g-2 align-items-end p-3 bg-light rounded border">
                    <div class="col-md-3">
                        <label class="form-label small fw-bold">Nombre Bot√≥n</label>
                        <input type="text" id="newLauncherLabel" class="form-control form-control-sm" placeholder="Ej: Word">
                    </div>
                    <div class="col-md-5">
                        <label class="form-label small fw-bold">Ruta Ejecutable (.exe)</label>
                        <div class="input-group input-group-sm">
                            <input type="text" id="newLauncherPath" class="form-control" placeholder="Ej: C:\Windows\System32\notepad.exe">
                            <button class="btn btn-outline-secondary" type="button" onclick="pickLauncherFile()">
                                <i class="bi bi-folder2-open"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label small fw-bold">Icono</label>
                        <div class="input-group input-group-sm">
                            <input type="text" id="newLauncherIcon" class="form-control" placeholder="Ej: box-arrow-up-right">
                            <button class="btn btn-outline-secondary" type="button" onclick="openIconSelector('newLauncherIcon')">
                                <i class="bi bi-search"></i>
                            </button>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-primary btn-sm w-100 fw-bold" type="button" onclick="addAppLauncher()">
                            <i class="bi bi-plus-lg"></i> A√±adir
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. Hotel & Sistema -->
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header py-3 bg-white">
                <h6 class="mb-0 fw-bold text-primary">
                    <i class="bi bi-building me-2"></i>Hotel y Sistema
                </h6>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label small fw-bold">Nombre del Hotel</label>
                        <input type="text" id="conf_hotel_nombre" class="form-control">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label small fw-bold">URL Servidor API</label>
                        <input type="text" id="conf_api_url" class="form-control">
                    </div>
                     <div class="col-md-4">
                        <label class="form-label small fw-bold">Precio Safe (‚Ç¨/d√≠a)</label>
                        <input type="number" step="0.01" id="conf_safe_precio" class="form-control">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label small fw-bold">Fondo de Caja (‚Ç¨)</label>
                        <input type="number" step="0.01" id="conf_caja_fondo" class="form-control" placeholder="2000.00">
                    </div>
                </div>
                <div class="row g-3 mt-1">
                    <div class="col-md-6">
                        <label class="form-label small fw-bold">Contrase√±a Admin (Opcional)</label>
                        <div class="input-group input-group-sm">
                             <input type="password" id="conf_admin_pass" class="form-control" placeholder="Dejar en blanco para desactivar">
                             <button class="btn btn-outline-secondary" type="button" onclick="Utils.togglePassword('conf_admin_pass')">
                                <i class="bi bi-eye"></i>
                             </button>
                        </div>
                        <div class="form-text text-muted" style="font-size: 0.75rem;">Para funciones sensibles como editar configuracion o borrar datos.</div>
                    </div>

                </div>
            </div>
        </div>

        <!-- 3. Configuraci√≥n de Habitaciones -->
        <div class="card mb-4 shadow-sm border-0">
            <div class="card-header py-3 bg-white">
                <h6 class="mb-0 fw-bold text-primary">
                    <i class="bi bi-door-open-fill me-2"></i>Gesti√≥n de Habitaciones
                </h6>
            </div>
            <div class="card-body">
                
                <!-- A. RANGOS -->
                <div class="mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <label class="form-label small fw-bold mb-0">Rangos de Habitaciones</label>
                        <span class="badge bg-secondary">Total: <span id="total-rooms-count">0</span> habs.</span>
                    </div>
                    
                    <div class="table-responsive border rounded mb-2">
                        <table class="table table-sm table-striped mb-0 text-center align-middle">
                            <thead class="table-light">
                                <tr>
                                    <th style="width: 20%">Planta</th>
                                    <th style="width: 30%">Desde</th>
                                    <th style="width: 30%">Hasta</th>
                                    <th style="width: 20%"></th>
                                </tr>
                            </thead>
                            <tbody id="config-rangos-table"></tbody>
                        </table>
                    </div>

                    <!-- Input Add Range -->
                    <div class="input-group input-group-sm">
                        <input type="number" id="newRangePlanta" class="form-control" placeholder="Planta">
                        <input type="number" id="newRangeMin" class="form-control" placeholder="Min (ej: 101)">
                        <input type="number" id="newRangeMax" class="form-control" placeholder="Max (ej: 120)">
                        <button class="btn btn-outline-primary" type="button" onclick="addRango()">
                            <i class="bi bi-plus-lg"></i>
                        </button>
                    </div>
                </div>

                <hr class="text-muted opacity-25">

                <!-- B. FILTROS -->
                <div class="row g-3">
                    <!-- Tipos -->
                    <div class="col-md-4">
                        <label class="form-label small fw-bold">Tipos (Suites, Doble...)</label>
                        <div id="list-filtros-tipos" class="d-flex flex-wrap gap-1 mb-2"></div>
                        <div class="input-group input-group-sm">
                            <input type="text" id="newFiltroTipoEmoji" class="form-control" style="max-width: 50px;" placeholder="üîπ">
                            <input type="text" id="newFiltroTipo" class="form-control" placeholder="Nombre...">
                            <button class="btn btn-outline-secondary" type="button" onclick="addFilter('TIPOS')"><i class="bi bi-plus"></i></button>
                        </div>
                    </div>
                    
                    <!-- Vistas -->
                    <div class="col-md-4">
                        <label class="form-label small fw-bold">Vistas (Mar, Calle...)</label>
                        <div id="list-filtros-vistas" class="d-flex flex-wrap gap-1 mb-2"></div>
                        <div class="input-group input-group-sm">
                            <input type="text" id="newFiltroVistaEmoji" class="form-control" style="max-width: 50px;" placeholder="üëÅÔ∏è">
                            <input type="text" id="newFiltroVista" class="form-control" placeholder="Nombre...">
                            <button class="btn btn-outline-secondary" type="button" onclick="addFilter('VISTAS')"><i class="bi bi-plus"></i></button>
                        </div>
                    </div>

                    <!-- Caracter√≠sticas -->
                    <div class="col-md-4">
                        <label class="form-label small fw-bold">Caracter√≠sticas (Jacuzzi...)</label>
                        <div id="list-filtros-carac" class="d-flex flex-wrap gap-1 mb-2"></div>
                        <div class="input-group input-group-sm">
                            <input type="text" id="newFiltroCaracEmoji" class="form-control" style="max-width: 50px;" placeholder="‚ú®">
                            <input type="text" id="newFiltroCarac" class="form-control" placeholder="Nombre...">
                            <button class="btn btn-outline-secondary" type="button" onclick="addFilter('CARACTERISTICAS')"><i class="bi bi-plus"></i></button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        
    </form>
</div>

<!-- MODAL NAVEGADOR DE ARCHIVOS WEB (Replazo del nativo) -->
<div class="modal fade" id="modalFileBrowser" tabindex="-1" aria-hidden="true" style="z-index: 10060;">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-dark text-white py-2">
                <h6 class="modal-title fw-bold"><i class="bi bi-folder2-open me-2"></i>Explorador del Sistema</h6>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-0">
                <div class="bg-light p-2 border-bottom d-flex gap-2 align-items-center">
                    <button class="btn btn-sm btn-outline-secondary" onclick="FileBrowser.up()"><i class="bi bi-arrow-up"></i></button>
                    <input type="text" id="fb-current-path" class="form-control form-control-sm fw-bold" readonly value="C:\">
                </div>
                <div id="fb-list" class="list-group list-group-flush overflow-auto" style="height: 350px;">
                    <!-- Items -->
                </div>
            </div>
            <div class="modal-footer py-1 bg-light">
                <small class="text-muted me-auto">Selecciona un archivo .exe</small>
                <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancelar</button>
            </div>
        </div>
    </div>
</div>
