<div class="d-none d-print-block report-header-print">
  <div class="report-info-left">
    <h2>Configuraci√≥n del Sistema</h2>
    <p>Hotel Garo√© ‚Ä¢ Recepci√≥n Suite</p>
  </div>
  <div class="report-info-right">
    <div><strong>Fecha:</strong> <span id="print-date-config"></span></div>
    <div>
      <strong>Generado por:</strong> <span id="print-repc-nombre-config"></span>
    </div>
  </div>
</div>

<!-- Encabezado del M√≥dulo (T√≠tulo Din√°mico) -->
<h4 class="module-title-discrete">
  <i class="bi bi-gear-fill"></i> CONFIGURACI√ìN
</h4>

<!-- Barra de Herramientas -->
<div class="module-toolbar no-print">
  <div class="btn-group" role="group">
    <button
      class="btn btn-outline-primary active"
      id="btnConfigMain"
      data-bs-toggle="tooltip"
      data-bs-title="Editar Configuraci√≥n"
    >
      <i class="bi bi-sliders me-2"></i>General
    </button>

  </div>

  <div class="btn-print-wrapper gap-2">
    <button
      class="btn btn-success btn-sm fw-bold shadow-sm"
      onclick="exportConfig()"
      data-bs-toggle="tooltip"
      data-bs-title="Descargar archivo JSON para guardar cambios permanentemente"
    >
      <i class="bi bi-download me-2"></i>Descargar config.json
    </button>
    <button
      class="btn btn-primary btn-sm fw-bold shadow-sm"
      onclick="saveConfigLocal()"
      data-bs-toggle="tooltip"
      data-bs-title="Aplicar cambios en este navegador"
    >
      <i class="bi bi-save-fill me-2"></i>Aplicar Cambios
    </button>
  </div>
</div>

<!-- Contenedor Principal -->
<div id="configuracion-content-wrapper" class="animate-fade-in">
  <form
    id="formConfig"
    autocomplete="off"
    onsubmit="
      event.preventDefault();
      saveConfigLocal();
    "
  >
    <!-- 1. Recepcionistas -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-people-fill me-2"></i>Equipo de Recepci√≥n
        </h6>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-3">
          Nombres que aparecer√°n en los selectores de usuario y firmas.
        </p>
        <div
          id="config-recepcionistas-list"
          class="d-flex flex-wrap gap-2 mb-3"
        ></div>

        <div class="input-group input-group-sm" style="max-width: 400px">
          <input
            type="text"
            id="newRecepcionista"
            class="form-control"
            placeholder="Nuevo nombre..."
          />
          <button
            class="btn btn-outline-primary"
            type="button"
            onclick="addRecepcionista()"
          >
            <i class="bi bi-plus-lg"></i> A√±adir
          </button>
        </div>
      </div>
    </div>

    <!-- 1.1 Transfers & Destinos -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-airplane-engines-fill me-2"></i>Transfers & Destinos
        </h6>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-3">
          Destinos habituales para las opciones de Transfers (p. ej. Aeropuertos).
        </p>
        <div
          id="list-destinos-transfers"
          class="d-flex flex-wrap gap-2 mb-3"
        ></div>

        <div class="input-group input-group-sm" style="max-width: 400px">
          <input
            type="text"
            id="newDestinoTransfer"
            class="form-control"
            placeholder="Nuevo destino (ej: Aeropuerto)..."
          />
          <button
            class="btn btn-outline-primary"
            type="button"
            onclick="addDestinoTransfer()"
          >
            <i class="bi bi-plus-lg"></i> A√±adir
          </button>
        </div>
      </div>
    </div>

    <!-- 1.15 Departamentos del Hotel (Global Master List) -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-building-check me-2"></i>Departamentos del Hotel
        </h6>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-3">
          Lista maestra de departamentos para Novedades, Aver√≠as y Lista de Precios.
        </p>
        <div
          id="list-departamentos-global"
          class="d-flex flex-wrap gap-2 mb-3"
        ></div>

        <div class="input-group input-group-sm" style="max-width: 400px">
          <input
            type="text"
            id="newDepartamentoGlobal"
            class="form-control"
            placeholder="Nuevo departamento (ej: Cocina)..."
          />
          <button
            class="btn btn-outline-primary"
            type="button"
            onclick="addDepartamentoGlobal()"
          >
            <i class="bi bi-plus-lg"></i> A√±adir
          </button>
        </div>
      </div>
    </div>

    <!-- 1.2 Ejecutables / Apps Externas -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-grid-3x3-gap-fill me-2"></i>Lanzador de Aplicaciones (LaunchPad)
        </h6>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-3">
          Configura los accesos directos que aparecen en el men√∫ "LaunchPad". 
          Puedes a√±adir programas (.exe) o carpetas locales.
        </p>

        <!-- Container for list -->
        <div id="list-app-launchers" class="row g-2 mb-3"></div>

        <!-- Add Form -->
        <div class="p-3 bg-light rounded border">
            <div class="row g-2 align-items-end">
                <div class="col-md-2">
                    <label class="form-label small fw-bold">Tipo</label>
                    <select id="newLauncherType" class="form-select form-select-sm" onchange="Configurator.onLauncherTypeChange(this.value)">
                        <option value="app">Aplicaci√≥n / Archivo</option>
                        <option value="folder">Carpeta</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="form-label small fw-bold">Nombre</label>
                    <input type="text" id="newLauncherLabel" class="form-control form-control-sm" placeholder="Ej: Word">
                </div>
                <div class="col-md-4">
                    <label id="labelLauncherPath" class="form-label small fw-bold">Ruta</label>
                    <div class="input-group input-group-sm">
                        <input type="text" id="newLauncherPath" class="form-control" placeholder="C:\Program Files\...">
                        <button class="btn btn-outline-secondary" type="button" onclick="pickLauncherFile()">
                            <i class="bi bi-folder2-open"></i>
                        </button>
                    </div>
                </div>
                <div class="col-md-2">
                    <label class="form-label small fw-bold">Icono (Opcional)</label>
                    <div class="input-group input-group-sm">
                        <button class="btn btn-outline-secondary" type="button" onclick="IconSelector.open('newLauncherIcon')" title="Elegir Icono">
                            <i class="bi bi-palette"></i>
                        </button>
                        <input type="text" id="newLauncherIcon" class="form-control" placeholder="bi-box">
                    </div>
                </div>
                <div class="col-md-1">
                    <button class="btn btn-primary btn-sm w-100 fw-bold" type="button" onclick="addAppLauncher()">
                        <i class="bi bi-plus-lg"></i>
                    </button>
                </div>
            </div>
        </div>
      </div>
    </div>

    <!-- 1.25 Cat√°logo de Excursiones & Tickets -->
    <div class="card mb-4 shadow-sm border-0">
      <div
        class="card-header py-3 bg-white d-flex justify-content-between align-items-center"
      >
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-ticket-perforated-fill me-2"></i>Cat√°logo de
          Excursiones & Tickets
        </h6>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-3">
          Define los productos disponibles, sus operadores y precios base.
        </p>

        <div class="table-responsive border rounded mb-3">
          <table id="table-excursiones" class="table table-sm table-hover align-middle mb-0">
            <thead class="table-light small">
              <tr>
                <th data-sort="nombre">Nombre del Producto</th>
                <th data-sort="operador">Operador</th>
                <th class="text-center" data-sort="precioAdulto">Adulto</th>
                <th class="text-center" data-sort="precioNi√±o">Ni√±o</th>
                <th class="text-center" data-sort="esTicket">Tipo</th>
                <th class="text-end"></th>
              </tr>
            </thead>
            <tbody id="config-excursiones-list"></tbody>
          </table>
        </div>

        <div class="row g-2 align-items-end p-3 bg-light rounded border">
          <div class="col-md-3">
            <label class="form-label small fw-bold">Nombre</label>
            <input
              type="text"
              id="newExc_nombre"
              class="form-control form-control-sm"
              placeholder="Ej: Loro Parque"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">Operador</label>
            <input
              type="text"
              id="newExc_operador"
              class="form-control form-control-sm"
              placeholder="Ej: Atlan-T"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">‚Ç¨ Adulto</label>
            <input
              type="number"
              step="0.01"
              id="newExc_pAdulto"
              class="form-control form-control-sm text-center"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">‚Ç¨ Ni√±o</label>
            <input
              type="number"
              step="0.01"
              id="newExc_pNi√±o"
              class="form-control form-control-sm text-center"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">‚Ç¨ Grupo</label>
            <input
              type="number"
              step="0.01"
              id="newExc_pGrupo"
              class="form-control form-control-sm text-center"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">Categor√≠a</label>
            <select id="newExc_esTicket" class="form-select form-select-sm">
              <option value="false">üèûÔ∏è Excursi√≥n</option>
              <option value="true">üéüÔ∏è Ticket/Entrada</option>
            </select>
          </div>
          <div class="col-md-1">
            <button
              class="btn btn-primary btn-sm w-100 fw-bold"
              type="button"
              onclick="Configurator.addExcursionAlCatalogo()"
            >
              <i class="bi bi-plus-lg"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- 1.28 Instalaciones del Hotel -->
    <div class="card mb-4 shadow-sm border-0">
      <div
        class="card-header py-3 bg-white d-flex justify-content-between align-items-center"
      >
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-geo-fill me-2"></i>Instalaciones del Hotel
        </h6>
      </div>
      <div class="card-body">
        <p class="small text-muted mb-3">
          Gestiona las partes del hotel que se pueden reservar (Canchas de
          tenis, Gimnasio, etc.) con sus horarios.
        </p>

        <div
          id="config-instalaciones-list"
          class="d-flex flex-wrap gap-2 mb-3"
        ></div>

        <div class="row g-2 align-items-end p-3 bg-light rounded border">
          <div class="col-md-3">
            <label class="form-label small fw-bold">Nombre</label>
            <input
              type="text"
              id="newInst_nombre"
              class="form-control form-control-sm"
              placeholder="Ej: Cancha de Tennis"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">Apertura</label>
            <input
              type="time"
              id="newInst_apertura"
              class="form-control form-control-sm"
              value="08:00"
            />
          </div>
          <div class="col-md-2">
            <label class="form-label small fw-bold">Cierre</label>
            <input
              type="time"
              id="newInst_cierre"
              class="form-control form-control-sm"
              value="21:00"
            />
          </div>
          <div class="col-md-3">
            <label class="form-label small fw-bold">Icono</label>
            <div class="input-group input-group-sm">
              <button
                class="btn btn-outline-secondary"
                type="button"
                onclick="IconSelector.open('newInst_icono')"
                title="Elegir Icono"
              >
                <i class="bi bi-palette"></i>
              </button>
              <input
                type="text"
                id="newInst_icono"
                class="form-control"
                placeholder="bi-activity"
              />
            </div>
          </div>
          <div class="col-md-2">
            <button
              class="btn btn-primary btn-sm w-100 fw-bold"
              type="button"
              onclick="Configurator.addInstalacion()"
            >
              <i class="bi bi-plus-lg me-1"></i>A√±adir
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- 1.3 Rutas del Sistema -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-folder-symlink-fill me-2"></i>Rutas del Sistema
        </h6>
      </div>
      <div class="card-body">
        <div class="alert alert-light border small text-muted mb-3">
          <i class="bi bi-info-circle me-1"></i> Configura d√≥nde se guardan los
          archivos multimedia. Las rutas relativas se resuelven desde la carpeta
          ra√≠z del proyecto.
        </div>

        <div class="row g-3 items-align-end">
          <div class="col-md-12">
            <label class="form-label small fw-bold"
              >Ruta de Galer√≠a de Im√°genes</label
            >
            <div class="input-group">
              <span class="input-group-text bg-white"
                ><i class="bi bi-folder-symlink"></i
              ></span>
              <input
                type="text"
                id="conf_gallery_path"
                class="form-control"
                placeholder="Ej: resources/informacion"
              />
              <button
                class="btn btn-outline-secondary"
                type="button"
                onclick="pickGalleryFolder()"
              >
                <i class="bi bi-folder2-open"></i> Explorar
              </button>
            </div>
            <div class="form-text text-muted" style="font-size: 0.75rem">
              Carpeta escaneada por el m√≥dulo de Galer√≠a.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 2. Hotel & Sistema -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-building me-2"></i>Hotel y Sistema
        </h6>
      </div>
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label small fw-bold">Nombre del Hotel</label>
            <input type="text" id="conf_hotel_nombre" class="form-control" />
          </div>
          <div class="col-md-6">
            <label class="form-label small fw-bold">URL Servidor API</label>
            <input type="text" id="conf_api_url" class="form-control" />
          </div>
          <div class="col-md-4">
            <label class="form-label small fw-bold">Precio Safe (‚Ç¨/d√≠a)</label>
            <input
              type="number"
              step="0.01"
              id="conf_safe_precio"
              class="form-control"
            />
          </div>
          <div class="col-md-4">
            <label class="form-label small fw-bold">Fondo de Caja (‚Ç¨)</label>
            <input
              type="number"
              step="0.01"
              id="conf_caja_fondo"
              class="form-control"
              placeholder="2000.00"
            />
          </div>
          <div class="col-md-4">
            <label class="form-label small fw-bold">Intervalo Sincro (ms)</label>
            <input
              type="number"
              step="1000"
              id="conf_sync_interval"
              class="form-control"
              placeholder="10000"
            />
          </div>
        </div>
        <div class="row g-3 mt-1">
          <div class="col-md-6">
            <label class="form-label small fw-bold"
              >Contrase√±a Admin (Opcional)</label
            >
            <div class="input-group input-group-sm">
              <input
                type="password"
                id="conf_admin_pass"
                class="form-control"
                placeholder="Dejar en blanco para desactivar"
              />
              <button
                class="btn btn-outline-secondary"
                type="button"
                onclick="Utils.togglePassword('conf_admin_pass')"
              >
                <i class="bi bi-eye"></i>
              </button>
            </div>
            <div class="form-text text-muted" style="font-size: 0.75rem">
              Para funciones sensibles como editar configuracion o borrar datos.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 3. Configuraci√≥n de Habitaciones -->
    <div class="card mb-4 shadow-sm border-0">
      <div class="card-header py-3 bg-white">
        <h6 class="mb-0 fw-bold text-primary">
          <i class="bi bi-door-open-fill me-2"></i>Gesti√≥n de Habitaciones
        </h6>
      </div>
      <div class="card-body">
        <!-- A. RANGOS -->
        <div class="mb-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label small fw-bold mb-0"
              >Rangos de Habitaciones</label
            >
            <span class="badge bg-secondary"
              >Total: <span id="total-rooms-count">0</span> habs.</span
            >
          </div>

          <div class="table-responsive border rounded mb-2">
            <table
              id="table-rangos"
              class="table table-sm table-striped mb-0 text-center align-middle"
            >
              <thead class="table-light">
                <tr>
                  <th style="width: 20%" data-sort="planta">Planta</th>
                  <th style="width: 30%" data-sort="min">Desde</th>
                  <th style="width: 30%" data-sort="max">Hasta</th>
                  <th style="width: 20%"></th>
                </tr>
              </thead>
              <tbody id="config-rangos-table"></tbody>
            </table>
          </div>

          <!-- Input Add Range -->
          <div class="input-group input-group-sm">
            <input
              type="number"
              id="newRangePlanta"
              class="form-control"
              placeholder="Planta"
            />
            <input
              type="number"
              id="newRangeMin"
              class="form-control"
              placeholder="Min (ej: 101)"
            />
            <input
              type="number"
              id="newRangeMax"
              class="form-control"
              placeholder="Max (ej: 120)"
            />
            <button
              class="btn btn-outline-primary"
              type="button"
              onclick="addRango()"
            >
              <i class="bi bi-plus-lg"></i>
            </button>
          </div>
        </div>

        <hr class="text-muted opacity-25" />

        <!-- B. FILTROS -->
        <div class="row g-3">
          <!-- Tipos -->
          <div class="col-md-4">
            <label class="form-label small fw-bold"
              >Tipos (Suites, Doble...)</label
            >
            <div
              id="list-filtros-tipos"
              class="d-flex flex-wrap gap-1 mb-2"
            ></div>
            <div
              class="input-group input-group-sm shadow-sm border rounded overflow-hidden"
            >
              <button
                class="btn btn-light border-0 px-3 bg-white"
                type="button"
                onclick="IconSelector.open('newFiltroTipoEmoji')"
                title="Elegir Icono"
                style="min-width: 60px"
              >
                <span id="preview-newFiltroTipoEmoji"
                  ><i class="bi bi-palette text-primary fs-5"></i
                ></span>
                <input type="hidden" id="newFiltroTipoEmoji" value="" />
              </button>
              <input
                type="text"
                id="newFiltroTipo"
                class="form-control border-0 py-2 fw-bold"
                placeholder="Nombre..."
              />
              <button
                class="btn btn-primary px-3"
                type="button"
                onclick="addFilter('TIPOS')"
              >
                <i class="bi bi-plus-lg"></i>
              </button>
            </div>
          </div>

          <!-- Vistas -->
          <div class="col-md-4">
            <label class="form-label small fw-bold"
              >Vistas (Mar, Calle...)</label
            >
            <div
              id="list-filtros-vistas"
              class="d-flex flex-wrap gap-1 mb-2"
            ></div>
            <div
              class="input-group input-group-sm shadow-sm border rounded overflow-hidden"
            >
              <button
                class="btn btn-light border-0 px-3 bg-white"
                type="button"
                onclick="IconSelector.open('newFiltroVistaEmoji')"
                title="Elegir Icono"
                style="min-width: 60px"
              >
                <span id="preview-newFiltroVistaEmoji"
                  ><i class="bi bi-palette text-primary fs-5"></i
                ></span>
                <input type="hidden" id="newFiltroVistaEmoji" value="" />
              </button>
              <input
                type="text"
                id="newFiltroVista"
                class="form-control border-0 py-2 fw-bold"
                placeholder="Nombre..."
              />
              <button
                class="btn btn-primary px-3"
                type="button"
                onclick="addFilter('VISTAS')"
              >
                <i class="bi bi-plus-lg"></i>
              </button>
            </div>
          </div>

          <!-- Caracter√≠sticas -->
          <div class="col-md-4">
            <label class="form-label small fw-bold"
              >Caracter√≠sticas (Jacuzzi...)</label
            >
            <div
              id="list-filtros-carac"
              class="d-flex flex-wrap gap-1 mb-2"
            ></div>
            <div
              class="input-group input-group-sm shadow-sm border rounded overflow-hidden"
            >
              <button
                class="btn btn-light border-0 px-3 bg-white"
                type="button"
                onclick="IconSelector.open('newFiltroCaracEmoji')"
                title="Elegir Icono"
                style="min-width: 60px"
              >
                <span id="preview-newFiltroCaracEmoji"
                  ><i class="bi bi-palette text-primary fs-5"></i
                ></span>
                <input type="hidden" id="newFiltroCaracEmoji" value="" />
              </button>
              <input
                type="text"
                id="newFiltroCarac"
                class="form-control border-0 py-2 fw-bold"
                placeholder="Nombre..."
              />
              <button
                class="btn btn-primary px-3"
                type="button"
                onclick="addFilter('CARACTERISTICAS')"
              >
                <i class="bi bi-plus-lg"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
