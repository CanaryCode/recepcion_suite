<!-- Encabezado del M√≥dulo (T√≠tulo Din√°mico) -->
<h4 class="module-title-discrete">
    <i class="bi bi-box-seam-fill"></i> Objetos Perdidos (Lost & Found)
</h4>

<!-- Barra de Herramientas y Vistas -->
<div class="module-toolbar no-print">
    <div class="btn-group shadow-sm" role="group">
        <button class="btn btn-outline-primary active fw-bold" id="btnLostFoundVistaTrabajo" data-bs-toggle="tooltip"
            data-bs-title="Registrar nuevo objeto">
            <i class="bi bi-pencil-square me-2"></i>Edici√≥n
        </button>
        <button class="btn btn-outline-primary fw-bold" id="btnLostFoundVistaLista" data-bs-toggle="tooltip"
            data-bs-title="Ver listado de objetos">
            <i class="bi bi-list-ul me-2"></i>Listado
        </button>
    </div>

    <div class="btn-print-wrapper">
                <button class="btn btn-primary btn-sm fw-bold shadow-sm" onclick="lostFoundModule.printReport()">
                    <i class="bi bi-printer me-1"></i> Imprimir Reporte
                </button>
    </div>
</div>

<!-- Contenedor Principal (VISTA TRABAJO) -->
<div id="lost-found-trabajo" class="animate-fade-in">
    <div class="row">
        <!-- Formulario Izquierda -->
        <div class="col-md-5">
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-header py-3 bg-white">
                    <h6 class="mb-0 fw-bold text-primary">
                        <i class="bi bi-plus-circle me-2"></i>Nuevo Registro
                    </h6>
                </div>
                <form id="formLostFound" class="card-body">
                    <input type="hidden" id="lost_found_id">
                    
                    <div class="mb-3">
                        <label class="form-label small fw-bold">Fecha del Hallazgo *</label>
                        <input type="date" id="lost_found_fecha" class="form-control form-control-sm" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">Objeto / Descripci√≥n *</label>
                        <input type="text" id="lost_found_objeto" class="form-control form-control-sm" 
                            placeholder="Ej: Gafas de sol negras Ray-Ban" required autocomplete="off">
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">Lugar del Hallazgo *</label>
                        <input type="text" id="lost_found_lugar" class="form-control form-control-sm" 
                            placeholder="Ej: Hab 204, Piscina, Lobby..." required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">¬øQui√©n lo encontr√≥? *</label>
                        <input type="text" id="lost_found_quien" class="form-control form-control-sm" 
                            placeholder="Nombre del empleado" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">Estado Inicial</label>
                        <select id="lost_found_estado" class="form-select form-select-sm fw-bold">
                            <option value="Almacenado" selected>üì¶ Almacenado</option>
                            <option value="Entregado">ü§ù Entregado</option>
                            <option value="Donado">üïäÔ∏è Donado</option>
                            <option value="Desechado">üóëÔ∏è Desechado</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">Im√°genes del Objeto</label>
                        <div class="d-flex flex-column gap-2">
                            <button type="button" class="btn btn-outline-secondary btn-sm" onclick="document.getElementById('lost_found_files').click()">
                                <i class="bi bi-images me-2"></i>Seleccionar Fotos
                            </button>
                            <input type="file" id="lost_found_files" class="d-none" multiple accept="image/*" onchange="lostFoundModule.handleFileSelection(event)">
                            
                            <!-- Preview Grid -->
                            <div id="lost_found_image_previews" class="d-flex flex-wrap gap-2 mt-2">
                                <!-- JS Injection -->
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label small fw-bold">Comentarios / Observaciones</label>
                        <textarea id="lost_found_comments" class="form-control form-control-sm" rows="3" 
                            placeholder="Detalles adicionales, n√∫mero de estante..." autocomplete="off"></textarea>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary fw-bold shadow-sm">
                            <i class="bi bi-save me-2"></i>Guardar Registro
                        </button>
                        <button type="button" class="btn btn-light btn-sm" onclick="lostFoundModule.limpiarFormulario()">
                            Cancelar / Nuevo
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Estad√≠sticas R√°pidas o Informaci√≥n Derecha -->
        <div class="col-md-7">
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-header py-3 bg-white">
                    <h6 class="mb-0 fw-bold text-muted">
                        <i class="bi bi-info-circle me-2"></i>Consideraciones
                    </h6>
                </div>
                <div class="card-body">
                    <ul class="small text-muted mb-0">
                        <li>Los objetos deben estar etiquetados con el n√∫mero de ID generado.</li>
                        <li>Se recomienda guardar objetos valiosos en la caja fuerte de recepci√≥n.</li>
                        <li>El plazo de almacenamiento est√°ndar es de 6 meses.</li>
                    </ul>
                </div>
            </div>

            <!-- √öltimos Registros (Mini Vista) -->
            <div class="card shadow-sm border-0">
                <div class="card-header py-3 bg-white d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-bold text-muted">Recientemente A√±adidos</h6>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0" style="font-size: 0.85rem;">
                        <thead class="table-light">
                            <tr>
                                <th>Fecha</th>
                                <th>Objeto</th>
                                <th>Lugar</th>
                                <th>Estado</th>
                                <th class="no-print"></th>
                            </tr>
                        </thead>
                        <tbody id="lostFoundRecentBody">
                            <!-- JS Injection -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contenedor Principal (VISTA LISTADO) -->
<div id="lost-found-lista" class="d-none animate-fade-in">
    <div class="card shadow-sm border-0">
        <div class="card-header py-3 bg-white">
            <div class="row g-2 align-items-center">
                <div class="col-md-4">
                    <div class="input-group input-group-sm">
                        <span class="input-group-text bg-white border-end-0"><i class="bi bi-search text-muted"></i></span>
                        <input type="text" id="searchLostFound" class="form-control border-start-0" 
                            placeholder="Buscar por objeto, lugar, quien..." autocomplete="off">
                    </div>
                </div>
                <div class="col-md-3">
                    <select id="filterLostFoundEstado" class="form-select form-select-sm fw-bold">
                        <option value="">Todos los Estados</option>
                        <option value="Almacenado">üì¶ Almacenado</option>
                        <option value="Entregado">ü§ù Entregado</option>
                        <option value="Donado">üïäÔ∏è Donado</option>
                        <option value="Desechado">üóëÔ∏è Desechado</option>
                    </select>
                </div>
                <div class="col-md-5 text-end">
                    <span class="badge bg-light text-dark border p-2">
                        Total: <span id="lostFoundTotalBadge" class="fw-bold">0</span>
                    </span>
                </div>
            </div>
        </div>
        <div class="table-responsive">
            <table id="table-lost-found" class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr class="table-light">
                        <th class="text-center" style="width: 80px;">Fotos</th>
                        <th class="text-center" style="width: 100px;" data-sort="fecha">
                            Fecha
                        </th>
                        <th data-sort="objeto">
                            Objeto
                        </th>
                        <th data-sort="lugar">
                            Lugar/Persona
                        </th>
                        <th class="text-center" style="width: 130px;" data-sort="estado">
                            Estado
                        </th>
                        <th class="text-center no-print" style="width: 100px;">Acciones</th>
                    </tr>
                </thead>
                <tbody id="lostFoundFullBody">
                    <!-- JS Injection -->
                </tbody>
            </table>
        </div>
        <!-- Sentinel for Infinite Scroll (si fuera necesario en el futuro) -->
        <div id="lost-found-sentinel"></div>
    </div>
</div>

<!-- Modal Detalle / Imagen -->
<div class="modal fade" id="modalLostFoundDetail" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content shadow-lg border-0 rounded-3">
            <div class="modal-header">
                <h5 class="modal-title fw-bold" id="lostFoundDetailTitle">Detalle de Objeto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-0">
                <div class="row g-0">
                    <div class="col-md-7 bg-light detail-gallery-column">
                        <div id="lostFoundDetailGallery" class="p-3 d-flex flex-wrap gap-2 justify-content-center align-content-start" style="min-height: 350px; max-height: 500px; overflow-y: auto;">
                            <!-- JS Injection (Images) -->
                        </div>
                        <div id="lostFoundDetailNoImg" class="text-muted text-center p-5" style="display: none;">
                            <i class="bi bi-image fs-1 d-block mb-2"></i>
                            Sin im√°genes adjuntas
                        </div>
                    </div>
                    <div class="col-md-5 p-4 border-start">
                        <div class="mb-3">
                            <label class="small text-muted fw-bold d-block">ID REGISTRO</label>
                            <span id="lostFoundDetailId" class="badge bg-secondary">#</span>
                        </div>
                        <div class="mb-3">
                            <label class="small text-muted fw-bold d-block">OBJETO</label>
                            <h4 id="lostFoundDetailObjeto" class="fw-bold text-primary"></h4>
                        </div>
                        <div class="row mb-3">
                            <div class="col-6">
                                <label class="small text-muted fw-bold d-block">FECHA</label>
                                <span id="lostFoundDetailFecha"></span>
                            </div>
                            <div class="col-6">
                                <label class="small text-muted fw-bold d-block">ESTADO</label>
                                <span id="lostFoundDetailEstadoBadge" class="badge"></span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="small text-muted fw-bold d-block">LUGAR / QUI√âN</label>
                            <p class="mb-0"><i class="bi bi-geo-alt me-2"></i><span id="lostFoundDetailLugar"></span></p>
                            <p class="mb-0"><i class="bi bi-person me-2"></i><span id="lostFoundDetailQuien"></span></p>
                        </div>
                        <div class="mb-0">
                            <label class="small text-muted fw-bold d-block">OBSERVACIONES</label>
                            <p id="lostFoundDetailComments" class="text-muted italic small"></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer bg-light border-0 py-3">
                <div class="me-auto no-print">
                    <button type="button" class="btn btn-outline-danger" id="btnLostFoundDeleteDetail">
                        <i class="bi bi-trash me-1"></i>Eliminar
                    </button>
                    <button type="button" class="btn btn-outline-primary ms-2" id="btnLostFoundEditFromDetail">
                        <i class="bi bi-pencil me-1"></i>Editar
                    </button>
                    <button type="button" class="btn btn-warning ms-2" id="btnLostFoundPrintDetail">
                        <i class="bi bi-printer me-1"></i>Imprimir Ticket
                    </button>
                </div>
                <button type="button" class="btn btn-secondary px-4 fw-bold shadow-sm" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>
